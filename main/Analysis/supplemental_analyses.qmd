---
title: "Supplemental_results"
format: html
editor: visual
toc: true
output:
  html_document:
    df_print: paged
---

# Load in packages

```{r, include=F}
library(groundhog)
pkgs <-  c("corrr","tidyverse","ggplot2","lme4","lmerTest", "ggeffects", "sjPlot", "insight", "data.table", "here", "arrow", "jtools", "r2glmm")
groundhog.day <- '2022-07-25'
groundhog.library(pkgs, groundhog.day)
here::i_am("main/Analysis/reportingResults.Rmd")
```

# Load in Data

```{r, include=F}
#study 1
longDf1 <- read_parquet(here("main","analysis","output","PFfullDf.parquet"))
distDf1 <- read_parquet(here("main","analysis","output","distanceDf.parquet"))
varDf1 <- read_parquet(here("main","analysis","output","varDf1.parquet"))
longDf1$partyN <- as.factor(longDf1$partyN)
longDf1$Rep <- as.factor(longDf1$Rep)
contrasts(longDf1$Rep) <- contr.sum(3)
longDf1$RepN <- as.factor(longDf1$RepN)
longDf1$RepN <- relevel(longDf1$RepN,"In")
longDf1$Info <- as.factor(longDf1$Info)
contrasts(longDf1$Info) <- contr.sum(2)
longDf1$partyN <- as.factor(longDf1$partyN)
contrasts(longDf1$partyN) <- contr.sum(2)
demDf <- subset(longDf1, partyN == "Dem")
repDf <- subset(longDf1, partyN == "Rep")
longDf1$politStre <- as.factor(abs(4-longDf1$Polit))
InfoDf1 <- subset(longDf1, Info == "Info")
issueDf1 <- longDf1[!duplicated(longDf1$issues),]
distDf1$polStrength <- as.factor(abs(4-distDf1$Polit))

#study 2
longDf2 <- read_parquet(here("main","analysis","output","PFfullDf2.parquet"))
distDf2 <- read_parquet(here("main","analysis","output","distanceDf2.parquet"))
varDf2 <- read_parquet(here("main","analysis","output","varDf2.parquet"))
longDf2$partyN <- as.factor(longDf2$partyN)
longDf2$Rep <- as.factor(longDf2$Rep)
longDf2$Rep <- factor(longDf2$Rep, c("Non","Rep","Dem"))
longDf2$Rep <- relevel(longDf2$Rep,"Non")
contrasts(longDf2$Rep) <- contr.sum(3)
longDf2$RepN <- as.factor(longDf2$RepN)
longDf2$RepN <- relevel(longDf2$RepN,"In")
longDf2$Info <- as.factor(longDf2$Info)
contrasts(longDf2$Info) <- contr.sum(2)
longDf2$partyN <- as.factor(longDf2$partyN)
contrasts(longDf2$partyN) <- contr.sum(2)
demDf <- subset(longDf2, partyN == "Dem")
repDf <- subset(longDf2, partyN == "Rep")
longDf2$politStre <- as.factor(abs(4-longDf2$Polit))
InfoDf2 <- subset(longDf2, Info == "Info")
issueDf2 <- longDf2[!duplicated(longDf2$issues),]
```

```{r}
S1Issues <- as.data.frame(unique(longDf1$label))
S2Issues <-as.data.frame(unique(longDf2$label.y))
colnames(S1Issues)[1] <- "label"
colnames(S2Issues)[1] <- "label"         

all_iss <- rbind(S1Issues, S2Issues) 
all_iss_col <- cbind(S1Issues, S2Issues)   
length(unique(unique(all_iss$label)))

unique <- length(S1Issues[S1Issues$label %in% S2Issues$label,])
```

# Similarity of Issues Predicting Similarity of Evaluations

## Effect of Group Norm

### Study 1

```{r}
m_sim_Info_1 <- lmer( scale(dist) ~ scale(corr) * Info + ( scale(corr) | subID), data = distDf1, control=lmerControl(optimizer="bobyqa",
                                optCtrl=list(maxfun=2e5)))
summary(m_sim_Info_1)
m_sim_Info_1_CI <- confint(m_sim_Info_1, method= "Wald")
m_sim_Info_1_R2 <- r2beta(m_sim_Info_1)
```

### Study 2

```{r}
m_sim_Info_2 <- lmer( scale(dist) ~ scale(corr) * Info + ( scale(corr) | subID), data = distDf2, control=lmerControl(optimizer="bobyqa",
                                optCtrl=list(maxfun=2e5)))
summary(m_sim_Info_2)
m_sim_Info_2_CI <- confint(m_sim_Info_2, method= "Wald")
```

## Effect of Affective Polarization

### Study 1

```{r}
m_sim_Aff_1<- lmer( scale(dist) ~ scale(corr) * scale(affPol) + ( scale(corr) | subID), data = distDf1, control=lmerControl(optimizer="bobyqa",
                                optCtrl=list(maxfun=2e5)))
summary(m_sim_Aff_1)
m_sim_Aff_1_CI <- confint(m_sim_Aff_1, method= "Wald")
```

### Study 2

```{r}
m_sim_Aff_2 <- lmer( scale(dist) ~ scale(corr) * scale(affPol) + ( scale(corr) | subID), data = distDf2, control=lmerControl(optimizer="bobyqa",
                                optCtrl=list(maxfun=2e5)))
summary(m_sim_Aff_2)
m_sim_Aff_2_CI <- confint(m_sim_Aff_2, method= "Wald")
```


## Interaction between Group Norms and Surveyor Affiliation

### Study 1

```{r}
m_sim_Info_Rep_1 <- lmer( scale(dist) ~ scale(corr) * Info * RepN + ( scale(corr) | subID), data = distDf1, control=lmerControl(optimizer="bobyqa",
                                optCtrl=list(maxfun=2e5)))
summary(m_sim_Info_Rep_1)
m_sim_Info_Rep_1_CI <- confint(m_sim_Info_Rep_1, method= "Wald")
```

### Study 2

```{r}
m_sim_Info_Rep_2 <- lmer( scale(dist) ~scale(corr) * Info * RepN  + ( scale(corr) | subID), data = distDf2, control=lmerControl(optimizer="bobyqa",
                                optCtrl=list(maxfun=2e5)))
summary(m_sim_Info_Rep_2)
m_sim_Info_Rep_1_CI <- confint(m_sim_Info_Rep_2, method= "Wald")
```

## Interaction between Group Norms and Affective Polarization

### Study 1

```{r}
m_sim_Info_Rep_1 <- lmer( scale(dist) ~ scale(corr) * Info * scale(affPol) + ( scale(corr) | subID), data = distDf1, control=lmerControl(optimizer="bobyqa",
                                optCtrl=list(maxfun=2e5)))
summary(m_sim_Info_Rep_1)
m_sim_Info_Rep_1_CI <- confint(m_sim_Info_Rep_1, method= "Wald")
```

### Study 2

```{r}
m_sim_Info_Rep_2 <- lmer( scale(dist) ~ scale(corr) * Info * scale(affPol) + ( scale(corr) | subID), data = distDf2, control=lmerControl(optimizer="bobyqa",
                                optCtrl=list(maxfun=2e5)))
summary(m_sim_Info_Rep_2)
m_sim_Info_Rep_2_CI <- confint(m_sim_Info_Rep_2, method= "Wald")
```

# Ideological Consistency as Variance Around Ingroup and Outgroup

## For Info manipulation

### Study 1

```{r}
m_cons_in_Info_1 <- lm(scale(varAroundIn) ~ Info, varDf1)
summary(m_cons_in_Info_1)
m_cons_in_Info_1_CI <- confint(m_cons_in_Info_1, method= "Wald")
m_cons_in_Info_1_CI <- r2beta(m_cons_in_Info_1, method= "Wald")

m_cons_out_Info_1 <- lm(scale(varAroundOut) ~ Info, varDf1)
summary(m_cons_out_Info_1)
m_cons_out_Info_1_CI  <- confint(m_cons_out_Info_1, method= "Wald")
m_cons_out_Info_1_CI <- r2beta(m_cons_out_Info_1, method= "Wald")

```

### Study 2

```{r}
m_cons_in_Info_2 <- lm(scale(varAroundIn) ~ Info, varDf2)
summary(m_cons_in_Info_2)
m_cons_in_Info_2_CI  <- confint(m_cons_in_Info_2, method= "Wald")

m_cons_out_Info_2<- lm(scale(varAroundOut) ~ Info, varDf2)
summary(m_cons_out_Info_2)
m_cons_out_Info_2_CI  <- confint(m_cons_out_Info_2, method= "Wald")
```

## Affective Polarization

### Study 1

```{r}
m_cons_in_Aff_1 <- lm(scale(varAroundIn) ~ scale(affPol), varDf1)
summary(m_cons_in_Aff_1)
m_cons_in_Aff_1_CI  <- confint(m_cons_in_Aff_1, method= "Wald")


m_cons_out_Aff_1 <- lm(scale(varAroundOut) ~ scale(affPol), varDf1)
summary(m_cons_out_Aff_1)
m_cons_out_Aff_1_CI  <- confint(m_cons_out_Aff_1, method= "Wald")
```

### Study 2

```{r}
m_cons_in_Aff_2 <- lm(scale(varAroundIn) ~ scale(affPol), varDf2)
summary(m_cons_in_Aff_2)
m_cons_in_Aff_2_CI  <- confint(m_cons_in_Aff_2, method= "Wald")

m_cons_out_Aff_2 <- lm(scale(varAroundOut) ~ scale(affPol), varDf2)
summary(m_cons_out_Aff_2)
m_cons_out_Aff_2_CI  <- confint(m_cons_out_Aff_2, method= "Wald")
```
